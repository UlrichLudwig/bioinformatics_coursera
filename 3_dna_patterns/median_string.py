from Bio.Alphabet import IUPAC
from Bio.Seq import Seq
import itertools
import sys


def dist(kmer1, kmer2):
    long_kmer = kmer1 if len(kmer1) >= len(kmer2) else kmer2
    short_kmer = kmer1 if len(kmer1) < len(kmer2) else kmer2
    min_dist = len(short_kmer)
    for i in range(len(long_kmer) - len(short_kmer) + 1):
        dist = 0
        for j in range(len(short_kmer)):
            if long_kmer[i + j] != short_kmer[j]:
                dist += 1
        min_dist = min(dist, min_dist)
    return min_dist

def dna_dist(kmer, dna):
    return sum(dist(kmer, line) for line in dna)

def median_string(dna, k):
    best_kmer, best_dist = None, sys.maxint
    for kmer in [Seq(''.join(c)) for c in
                 itertools.product(dna[0].alphabet.letters, repeat=k)]:
        dist = dna_dist(kmer, dna)
        if dist < best_dist:
            print best_kmer, best_dist, '->', kmer, dist
            best_kmer, best_dist = kmer[:], dist
    return best_kmer

def main():
    dna = [Seq(s, IUPAC.unambiguous_dna) for s in '''TAATCTGGGAAATAAGGACTTTACTCATATTGGACGAATATAAGCGGTGGCTAGCGGCGTTTGCTTGATCTATGATTTACGCCCCAGTTTGGTGACAGTTGGTCACGTGAGCAATGAACGATTCGTCATCAGGTTGCCGATCCCTGCACTACTTCTACGTTGTAGTCGTTCGGATACCTCCATGAGATAGGTAAGAACCGAGTGCCGAGGGCCTGCCGTATAGCGTACCCTAATGACGCCGGTCCCACTGGTCTATGGACCTGATAGGCGCGCGAAGCTTCCGGCAAAGGGGATGCTACGAACATTATTTAGGGTCCTAGCCCGGCAGCTTCTCATTCTGCGGTTTCAGGGCTGTTGCGTGCTCGCAGGAGCTGATGGACCAGTGTCTAAGATTCGCCTAATCTGGGAAATAA
    GGACTTTACTCATATTGGACGAATATAAGCGGTGGCTAGCGGCGTTTGCTTGATCTATGATTTACGCCCCAGTTTGGTGACAGTTGGTCACGTGAGCTAACGAGGATCGCGAAATGAACGATTCGTCATCAGGTTGCCGATCCCTGCACTACTTCTACGTTGTAGTCGTTCGGATACCTCCATGAGATAGGTAAGAACCGAGTGCCGAGGGCCTGCCGTATAGCGTACCCTAATGACGCCGGTCCCACTGGTCTATGGACCTGATAGGCGCGCGAAGCTTCCGGCAAAGGGGATGCTACGAACATTATTTAGGGTCCTAGCCCGGCAGCTTCTCATTCTGCGGTTTCAGGGCTGTTGCGTGCTCGCAGGAGCTGATGGACCAGTGTCTAAGATTCGCCTAATCTGGGAAATAA
    ATGCTGCATGGCCGAAAGGAATGACTCGAACCCACATGGCAAAAAATCGGAGCCCCGGAGACGGACTCTGGGCGGAGCATTCTCCTTTTCTCTCGGATCGCGACATTTCCCGTTCGATTTCTTGTTGATTTCCTTCCCGCATATGTATGCCGCCCAAGGTCGGGATAGAGTAAAGTCGTCACACCGATTAAAAATCGTTCAGACGACGCCTAACAAATCACTTGTTATTAGTGAATATGGTCCAACAGGAGTAGGATAGAACGATGGGTTAACCAAACCACGGGCCCGCGATTGGCCGCCATTTCGACAGTATCTGCTGACGAACACTCATGTCCAAAGTAGCTCCGATATTGGCGATTCCGAAGCGACGGCGGCGCAAGCGTCGGCGGAAGTTCAAGAGGGAATAAACAACT
    AATAGAATAGTATCCCTCTAGATAGATGGCAATAGTTGTATCGTAAACTGCGATTTCCGGTGCACCGGATAAGATATGGTCGTGTGACTCTTTCATTCGGAGAGTGTTTTAGTGCAGATAAAACTACGACGTACACACATTCCATACTGCGGCTTTTGTTGGGCTTGACTACTCTGATGCGATGTGTGGACCATGCAGAGGATCTTTGTCCTATTGCTCCGATGCAACTGTTACAGGAATAAGCAGTCCAAGCTAAAACCGATCTAGCATGGCTGTTAAAAGAGATCGCGAACCCAGCCTACGTTCTCTCGAACAATCACTGTTAGGACACTTGCTTTGTGGACGACAATGTCGCCTCTCAGAATTACACTTCAATTCGGGCAAACGGAGTCAGTTGTGCGATGAACCAGGTT
    AAAGGTTCGAGGGAGGTAGATGATCCTACAAGAGGAACCGGCTCCATAAAAGGATGGGTAGACTGCGTGAGTATCATTTATAAACTAGATCGCGAATCCACGATGCTGGTGGGCCGCCGAGCTAATCCGGTACATAAGATTTCTCCGGCTTTTTCCACGGGCTGAGGACAATGGTGTGACAGCTGTCAAGCCAAGGCTGGATCCCTAGTTTATGGCGCAACCGTGAAGGGTCAGTTTCACTTACGTCCCTTTTTGCATATCAACGATTCTTAATGTTCCCCCCGTCACAGAAGCCCGTACGAAGCCTAGCATCGACATTGTAGATGTGATGACGGGGCAACCTTCCAACGCGTCGAGATCTACAGAACTACAGCTACCAGTAATTGTCGCGAATCTAAAAAGTGCGTTGGCCG
    CCGACTTGACGCTAGGTAATTGGTCCTCGTCGCGCGGCTTTGTCGGTCAACCTGCGATACGCCAAGAGGGGCGACGCCTGTGAACGATGTGGCTGACAATGGAGAGCTTGTCGAGGGCTGACGACTGAAGGGGCAATTACAGGCGAGGTGACACCTGCCGGCTATATCACGTTACGTACTAATTATTTTGCGTATGGACATACGGCATGACTCTGGTTTCATTAGTTACATCATACATTGCTATACGGCCTATGATGACCAGCTCATGAAGGATCAATGTGGTCTGCTTCGAATAGACCGAGAAATAGTAGCACCTCCTTTATGCAATCGGATCGCGTTTGTAATCTTTCTACGCTTAAGCCCATCCTACTCTCCAGGGTTTATGAATCGGGGGCAAGACTTTTTTTTCTATA
    ATGGTTGACACTCTACTCACGCCCCGGCAATTTGCAGTTTACAGCAGTGTAATGCACGCAACCCCGGAGCCTGGATCGTTCAGGCGCCCTCGAGACTAATTTTGATTACTTGGACTTGGCGTACCAGCTCTCATGCATAATAACGGTCGGTGGCTGCGTCGACTGGATGCAGCGGGGAATCAAGGCGAAGAGGGCTTGACACGCAGTAGTATCTGTACAACATGTGCGACTACCATTAGTTCGGATCGGATCGCGAGGTACGGCTTAGACTACCTACATCGATTAGACGAACCCACCTCTCCTCGCTCGGATCGCAAAGGAAGAGGGCCCTGGAGCTCATTTCTGTCGTGAGCAAATAGAAAGGCCGGGTTCTAAAACGATAGCTAAGCTGCCCTCGAATAAAAAATGCCCTG
    ACCCGTCTATGCTCTAAGGCCGAAGCCACGCAATTGTTGAGATCCCCGCACGGGGGTTGCATCCGTTAAAAATCGTAAATCGCGCAAACGACAACGCCATCCACAAGTCTGTTCTGGGGAAAAGTGTGGCAGCTCGTCTCGACAACTTTTCAATAGAGAATAAATCGACAGTGATCATCGTCCTACCCCCACGGCTCTTGTTCCTTAAATCCTCTCGCGACGATAGGGAGACTCATACACCTACTGGTCGCCCTACCGGCCTTACTAGCTACAATCCCATGAGCGATTGAACTTGGCATGTGGAACCCACTTATCCCCAGTTGCAGTTGAGTGTACACGCAGTTTCGTAGCGACTCGTAGAAATGCGCTCAAAGGCAGGACTGGACCTCTCTAGGATGCGTTAGTTCATTTTG
    TAGAAATCGGATCGCATCGATTCCTGTATAATCTTATCGCCGGGTCATGTTTTACTTTCTCGGAGCGTTCCGGTATTTGTGGTATATGGCTTCTGTAGTAAGCAGACCAAGGCCAGCAAGCAACATCGCGACACCCTCGACTGCCGTCCGCCTCAGTATGATCTTTTCGAAAGGTTTAAGGGCCGATTTGAACATATGAAGATGGCACGCTTACTTGCTAGGTTTCATTTTCTGGATAGGATTCTGTATAACTCGGTACGCGCTAAGCATCCAGCTATAGCGCCCCCGGATTACTCGCGTGGCCTCTGCCACAAATGTTTTACTGGCCATCCATGGGACGGCGGTGAACCCCGTGACCTATACCCGTCCCTCCCGTCAACTCACAGCTGGGTGCGCGAGTTAACCCCGATTCG
    AATTCAAGGCGGATCCGCTTTAGCCCAGCTTACGAGGATCAGAATATGGGCGACCGTGAATTATAACTTGGTCTCTTCGGAGCGTCTGATCGTAAAATGTAGCGCGCAAGTCGTGGGACTCACTCCTTTAAGCCTCAACAGTCCTTAATAACCCACCAGCTAGTTGGTAATTTTATGGTATCGGTGGGCAGGGCATTCGGTAGCAAGAGCAAGCGTCAATGGTGCCAAGTCTTAATTAACGGAGACGCATCGGCCTCGTCCCGCAAGATATAACACGAAGTATGGGCTTCTATCAGCCGTGCAGAAGTGATCCCTAGGACCCAGCCCGAGATACAATGACATCAGATGTAATAGTACGCTGCGGTGAGCGATCTGGGACATAAATTTCATCGCGATTCCCATAAATTTCCCAT
    ACTGTCAGTCTGGAGGAAGGGGCCCTGATCAGCAATGATCTTCAGGGCGTCGAGCGGCCCTGGCTCAACGTGCGCATAGTTTGGTGCCCCCATTTTCTCCGCTACGATGACTGGAAGTCGAACTTACGCTGTCTCATCGCACATCAGGGCGGGAGTTGGAAGTAGGTAAACAACAAACTGCGAGGGAGATTGCGGGATATGAGAGGGAGTATGTTTGCGCAACCCGTCGGCCCTGGTACGTGCCCTGCCCCGTGGTCGACCTGGGCGGCTCGTGACGGGGCACCTCAGTCTTTGTTTGCTGGATATTCTAAGACAAGCAGTTCAATGCGCCCTCCCAGAACCAACTTAAATCGGATTTGGATCCTCATAAGAGAGAGGTGACACAGCCATGGGGAGCTTGCAAGAAGATGACG
    GCGTAGGAAATAGCCGTTGCTGCTAGTCAAAAACTATAGACGGTTGACATCATCAAAGTCAAGAGGCAAGCGACGATGCTGCCCCCAAGCCAAGAGGATAAATGACATCGCGATCGCAGCGCGGAAGGACTCACGGACCATACTAATGCAGACGTTGACTACAGGAAGTCTTACACTTACCAATCTGAGGCACACTGGGAGTTGAGAGAGCTGTCTCAGGCTCGAAGTCGATGTGCCTTTCTTCCGACTGAAATCCGCGAGTCACATAAACGGCGGCCTCTTCGAATGGTACTCTGTAGGATGTCCGCTACGCCGCTTGTGATACCCTGTTCCGGCGTACTGCGGGTATTAACATCATCACTTTCGTATGTGGCCCTTTCCTTAGTTCGAGTAACTGTCGAAAAGATGATAAC
    AACACACAGCGAATGCACGTCTTAGCAAGGTATAACCCAAATTCTAGTTTCATTAGTATCGATATTACACATACTATAGGACTCTCGCAAGGTTGGCTAAGTCCTAATCAATGTATTTATAGTGACGACGTGTCTTATACAGCGCACTACCGACATTACTCAACGGAGTGACTCACCCCCGCGGTTCAAGTGTCTGAGAGACGATTCTCCAGCTCGTAGCCGTGTCTGCACGTATGCCGGATCGCGATCCGCAGGACACCACAGCAAGCGAGTACTACGCGAGTGCCTCCACCTACCCTGCTTTGGGCCGGAGGCACAAAGTCGGATCTCTTCCCAGGCTCGGCCTGCGGCGGTTGGGTCCCCCGATGTATCATGCGAGCGAGAGAGTCAAGTCGGTCAGGGACGTGGCGTTC
    GACAAAAGTGGTGCCGGCTTATCGATGTCTTGGCGTTTTGTGGGACCTGTTGGATGGAGGAAACCACCTCTACCAACCCATAGCTTCCGAAGTTGGAACTTGGCACCCTAACCGTAAAGGCACCCTTCCTCTGATTGAACGAAGAAGTGCATCAACTCCGATGTTACGGCCACAAAAGCGATACGAACCCTGAGTCAGGCTGACGATTCGCATCCATAACCTTCATCGACCGGCAGTAGCAATCAGCTATGGACACACTAGTCCATTTGGACGGGCCTATATTCTAGTCAGACAAGAGAGGTATGTCGACGGCGATCGTAATAGGGATCGCGACGTACCCTCCGCACCACACGGAACTCTACGGATAGTTTCGAGAAGAGTCCGCCTCAGAATCGGAATTCCGTTGAAAACGT
    AGGCTAGGACACGCACCGGGGTAAACTCGGTTAGTCGGTGATAGCCCTCGTTCGGACGACCTATTTCGGTGACAGAGGACACTTCAGTCCATGTGCAGTGGTTGGACCTTAATAAGGCACAGATGCTATACGACGTCAGTCTAAATCGGATCGTTTATTACAGCTACAGCCCCCGGCGCCCGTCTGTCTCACTCGGGACCACCTCAAGGTCGAACCAATAGTTGTGGACATTGAAGTCTGCTGAACACCACATACGCTATATACTGCCACTGGCGCCAAATGTCGACACACCGTACGGGCGAGGAATGTTGACTCTTACTAAGAGGGAGATGTAGAAGCTGTATAACCACACCGGTTGAATTTTCGTCCCCATTGTGACACCGAACCTCACGAGGAAGATACAGTTTTCTTTG
    GAAGACAATTGGAAGCGTCGCCCGACTACCCCTCGTCTGAGACTATCGCATCGTGCATGGTCATGGCATCATTAGGACGTACAAGGAAGGTGCCTCCGTAGGAGGTGGACCCTTCTAAAGCGTGCGCAACATACCGCTCGGCTTATCTGAATTCTTTAGACAATATGGCTGTTATAGGTACTTATCTTCACCTGCATTTCGTACGACCGGGCTGGTTTGACTTAAGACCTGGTACAGGTTAGTCGTTGGAGACGGTCAATCGCTTAACAACTAAATCGGTGGGCGACGCCCCCTTGAATGCGGAGATTGAGTAGCCCGCTCAAGCCCTATATCCTAGTTTTTGCGCATGTAGCTTATAAGTCTTTTACCTCAGGCGTGGGGGACTTATCTGGGACTTTTATATATGGACAACC
    TAGACGATGATTTATACAAACGGACGAGAGGGGGCTGGGAGCGGTGCGAGGCTGCGCTCCCAGTCTGAAGATGGGGAATGTTATCTTCCATTCTGGTGTGGTCGACGCCGTGCTCGTCGTGAACCAAGCCCTATCCCCGCAATTTAGAGCGTATCGCCCTATCAGGCTGTTTGGGCTCTTGGATCCCTTGGAATATAATTATCGGGCCGGCAGGTTAGGCCATATACCTAGTCCGTAATGTGTTGGAGGGCGTCGCCGAATTGGAGGTCTAATCATTTGAGATACGAGACCGGTTGGTTTAGATTTAAGACAAGTCTTGGATGCCTCGGGGATGTATAGGCGTTCCTGTATAAATCGCTGCGCGACACTTTCCTCAGTGTCAGTGTCCAGATAGTAGGGTGCCTCTACCCGCA
    TTTCCTAAATCGCTCTGACTACGGCATCTCGAGTCTACCATGCTGTGTGGATTTTAAGAAGTATCCTAAGAATGACTATCTAGACGAACCTACCGCAAAAAGGGCCTGGTAATTCCACCTGATTAATCGAGGTCGAATCGAGTTACGACTGGGCGTTGTTAAATCGGAGGCCGAATAACTCGCTACATAAGTCAAAGGTGCTCTAAAGCTATACAAGTCACTGCGCGGGGGGATCACACTACTAACATGTAGTCCCAAAGTTACAAACCGAACCCGCCACTTTGCTTCTGCTACAAGGCCACATTGACTAATCATGACACTCAAGTGGTTCAACGCACCCGACTGCAATCATCTTGTCGCGATATTTCGTCCCGTTGTAGTTATCCAGCTATGTAGCCAAATTCAGGCCGTTG
    TATGTTACTGAGGCAATGATCGCCTAGTTGCGGAGTATCCTTTAGAGTGGGGACTCGGAGGGAATGATTGCTGTTTGGACTTACAGCAGGTCCTCAACCACCTGAATCCCAGGGTCTCCGAGAACTCAGCCTTCGGGGACGAAACCGAAAATTACGCTAATTCTGTACTTTGCCATCGGGTTGAGGACACCTTTCCTACATCTGGCGTGCGCGCTTGAACTGGGAGCATTGTTTATCCCTCGAGGCTAAATCGGATCAGTAGCCCGTGATCATTGGGATACGCGGTATGCATCGCACTCAACGGCACTGATCGAATAGTTATGTTCTTCGCTGAGCAAGTATGCACGAGCATTGACTGAGCCGAGACGATTTGAGCTTATGTAACCCCTCTATCAGCTCGCGACATGCGTCTT
    GTATCAGCGAAAAGGAAAGGTACTGAGTCCTTTCGAGGTGTCAGGACGTCGCCTCCCCCGTCACATGCCTGATTAGGTCTTGCGGCTCTAAATCACTTCGCGATAGCGGCAACAACTGTTCCCCGGTCGGGCAAGTAACGCCCGCACTGGCCAGATCTTACAATCATATTTTTTACCAGCCTAATCGCGATGTCATTCGCATATTACGTATTATGCACACCACAGCTATGTGTTTCATGCCCAGAGAGCGATCTTCTTAGGCCGGCAGATTGCATAGCTATACGAAACTGGTTTAGCGTCCTTGGCATGCACGCCATAGACAATCAACACCTCTGGACAAATCATCACAGGCCCTTCAACAAACCAATGGGCGAAGGGTTCGTGCGTATGCGCCTTGACGGCAATGAGACGAG'''.split('\n')]

    #print dna_dist('GAC', dna)

    print median_string(dna, 15)

if __name__ == '__main__':
    main()